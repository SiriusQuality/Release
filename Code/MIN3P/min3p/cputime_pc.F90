!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/cputime_pc.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function cputime
!c ------------------------
!c
!c determine cputime
!c
!c written by:      Uli Mayer - September 28, 2000
!c
!c last modified:
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           cputime          = cpu-time                              * +
!c
!c common:   -
!c 
!c local:    time             = cpu-time in seconds 
!c
!c external: cpu_time  = returns cpu-time in seconds
!c ----------------------------------------------------------------------

!> Determine cputime
!> Note: fortran internal function cpu_time is the total cpu time of all threads of a process.
!> For multi-threaded process (e.g., openmp), use omp_get_wtime instead.
      real*8 function cputime()      
      
#ifdef OPENMP
      use omp_lib      
#endif  

      implicit none
      
#ifdef PETSC_V3_6_X
#include <petsc/finclude/petscsys.h>
#elif PETSC
#include <finclude/petscsys.h>
#endif
      
      !real*8 time
#ifndef OPENMP
#ifndef PETSC
      integer :: count, count_rate, count_max
#endif
#endif

!c  Visual Fortran intrinsic functions
!
!cintellinux *** replace by compiler specific function ***
#ifdef OPENMP
      cputime = omp_get_wtime()
#elif MPI
      cputime = MPI_Wtime()
#else
      !call cpu_time(time) 
      !cpu_time() is compiler specific, the norm is milliseconds, low precision.
      !use wall clock time to get a higher precision time. DSU, 2014-04-04
      call system_clock(count, count_rate, count_max)
      cputime = real(count)/real(count_rate)
#endif 
      return
      end
