!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 3 $
!> $Author: dsu $
!> $Date: 2012-12-10 03:46:07 +0100 (Mon, 10 Dec 2012) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/sorbconc.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine sorbconc
!c -------------------
!c
!c compute adsorbed concentration due to non-competitive sorption
!c reactions based on equilibrated solution composition
!c
!c written by:      Uli Mayer - June 22, 2002
!c
!c last modified:   - 
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           tota(nc)           = total sorbed component              * +
!c                                concentrations
!c                                non-competitive sorption
!c                                [moles/l bulk)
!c           totc(n)            = total component concentrations      + -
!c                                [moles/l water]  
!c           distcoff(nc)       = sorption distribution coefficient   + -
!c                                [l h2o/l bulk] 
!c           sw                 = water saturation                    + -
!c           por                = porosity                            + -
!c
!c           integer*4:
!c           ----------
!c           ilog               = unit number - logbook               + -
!c
!c common:   
!c chem.f:   real*8:
!c           -------
!c           distcoff_lc(nc)    = 
!c
!c           integer*4:
!c           ----------
!c           nc                 = number of components including h2o  + -
!c           
!c
!c           character:
!c           ----------
!c           isotherm_type(nc)  = definition of sorption isotherm     + -   
!c                                'none' = no sorption
!c                                'linear' = linear adsorption
!c                                'freundlich' = Freundlich isotherm
!c                                'langmuir' = Langmuir isotherm
!c
!c local:    real*8:
!c           -------
!c           r0                 = constant
!c
!c           integer*4:
!c           ----------
!c           ic                 = counter (components)
!c     
!c           character:
!c           ----------
!c           zone_name          = name of zone
!c
!c
!c external: 
!c ----------------------------------------------------------------------
 
      subroutine sorbconc(tota,totc,distcoff,sw,por,ilog)
 
      use parm
      use chem
 
      implicit real*8 (a-h,o-z)

      character*72 zone_name 

      dimension totc(*),tota(*),distcoff(*)

      parameter (r0 = 0.0d0)

!c  report to log file

      zone_name = 'adsorbed concentrations - non-competitive sorption'
      write(ilog,'(/a/72a/)') zone_name,('-',i=1,72)

!c  compute sorbed concentrations

      do ic = 1,nc-1

!c  linear isotherm

	  if (isotherm_type(ic).eq.'linear') then

	    tota(ic) = distcoff(ic)*sw*por*totc(ic)

!c  no isotherm specified
      
	  elseif (isotherm_type(ic).eq.'none') then
	      
	    tota(ic) = r0
	    
	  end if

      end do         !(loop over components)

	do ic = 1,nc-1
	  write(*,*) totc(ic),tota(ic),isotherm_type(ic)
	end do
	pause

      return
      end
