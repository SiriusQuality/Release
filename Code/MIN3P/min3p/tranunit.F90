!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/tranunit.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine tranunit
!c -------------------
!c
!c assign unit numbers for transient data 
!c      
!c written by:      Uli Mayer - February 5, 98 
!c
!c last modified:   Uli Mayer - July 27, 01
!c                  added unit number for flow variables
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c 
!c                                                                    I O
!c passed:   integer*4:
!c           ----------
!c           igb                = pointer to current spatial location + -
!c
!c common:   
!c parm.f:   -
!c
!c gen.f:    integer*4:
!c           ----------
!c           igbb               = unit number, concentrations of      * +
!c                                             sorbed species
!c                                             - transient data
!c                                               global system
!c           igbc               = unit number, free species and       * +
!c                                             secondary aqueous
!c                                             species concentrations
!c                                             - transient data
!c                                               global system
!c           igbd               = unit number, dissolution-           * +
!c                                             precipitation
!c                                             rates
!c                                             - transient data
!c                                               global system
!c           igbg               = unit number, gas concentrations     * +
!c                                             - transient data
!c                                                global system
!c           igbgr              = unit number, degassing rates        * +
!c                                             - transient data
!c                                                global system
!c           igbm               = unit number, master variables       * +
!c                                             - transient data
!c                                               global system
!c           igbi               = unit number, rates of intra-aqueous * +
!c                                             kinetic reactions
!c                                             - transient data
!c                                               global system
!c           igbp               = unit number, flow variables         * +
!c                                             - transient data
!c                                               global system
!c           igbs               = unit number, saturation indices     * +
!c                                             - transient data
!c                                               global system
!c           igbt               = unit number, total aqueous          * +
!c                                             component
!c                                             concentrations
!c                                             - transient data
!c                                               global system
!c           igbv               = unit number, mineral volume         * +
!c                                             fractions
!c                                             - transient data
!c                                               global system
!c           igbx               = unit number, saturation indices     * +
!c                                             excluded minerals
!c                                             - transient data
!c                                               global system
!c
!c
!c chem.f:   integer*4:
!c           ----------
!c           naq                = number of intra-aqueous kinetic     + -
!c                                reactions
!c           ng                 = number of gases                     + -
!c           nm                 = number of minerals                  + -
!c           nmx                = number of excluded minerals         + -
!c           nr                 = number of redox couples             + -
!c           nsb                = number of sorbed species            + -
!c           nsb_ion            = number of sorbed species            + -
!c                                (ion-exchange)
!c           nsb_surf           = number of sorbed species            + -
!c                                (surface-complex)
!c
!c           logical:
!c           --------
!c           gas_removal        = .true.  -> degassing of dissolved   + -
!c                                           gases, if confining
!c                                           pressure exceeded
!c           noncompetitive_sorption = logical array for activation   + -   
!c                                     of noncompetitive sorption
!c                                     reactions
!c
!c local:    igbinc             = increment for defining file 
!c                                unit numbers
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine tranunit(igb)
 
      use parm
      use gen
      use chem
      use file_unit, only : lun_set

      implicit none
      
      integer :: igb, igbinc

!c  assign unit numbers for output of transient data

      if (reactive_transport) then
        igbinc = 13
      else
        igbinc = 1
      end if

      igbp = igb_start+igbinc*(igb-1)     !flow variables
      call lun_set(igbp)

      if (reactive_transport) then
        igbt = igbp+1                     !total concentrations
        igbc = igbt+1                     !species concentrations
        igbm = igbt+2                     !master variables
        call lun_set(igbt)
        call lun_set(igbc)
        call lun_set(igbm)

        if (ng.gt.0) then
          igbg = igbt+3                   !partial gas pressures
          call lun_set(igbg)
          if (gas_removal) then
            igbgr = igbt+10               !degassing rates
            call lun_set(igbgr)
          end if
        end if

        if (naq.gt.0.or.nr.gt.0) then
          igbi = igbt+4                   !intra-aqueous kinetic reactions
          call lun_set(igbi)
        end if

        if (nsb_ion.gt.0.or.nsb_surf.gt.0.or.noncompetitive_sorption) then                
          igbb = igbt+5                   !sorbed species concentrations
          call lun_set(igbb)
        end if

        if (nm.gt.0) then
          igbs = igbt+6                   !saturation indices
          igbv = igbt+7                   !mineral volume fractions
          igbd = igbt+8                   !reaction rates
          call lun_set(igbs)
          call lun_set(igbv)
          call lun_set(igbd)
        end if

        if (nmx.gt.0) then
          igbx = igbt+9                   !saturation indices
          call lun_set(igbx)
        end if                            !excluded minerals
        
!c_isotope
        if (iso_output) then  !isotopic fractionation
          igbis = igbt+11
          call lun_set(igbis)
        end if

      end if

      return
      end
