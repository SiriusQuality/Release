!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/mem_heat.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_heat
!c ----------------- 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_heat 
       
      use parm
      use gen
      use chem
      use dens
#ifdef OPENMP
      use omp_lib 
#endif

      implicit none
      
      integer :: ierr

      external checkerr
      
      
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp parallel private(ierr)
    !$omp sections
#endif
#endif

#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (tempnew(nngl), stat = ierr)
      tempnew=0.0d0
      call checkerr(ierr,'tempnew',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif      
      allocate (tempold(nngl), stat = ierr)
      tempold=0.0d0
      call checkerr(ierr,'tempold',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (heatcaps(nngl), stat = ierr)
      heatcaps=0.0d0
      call checkerr(ierr,'heatcaps',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (heatcondw(nngl,3), stat = ierr)
      heatcondw=0.0d0
      call checkerr(ierr,'heatcondw',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (heatconds(nngl,3), stat = ierr)
      heatconds=0.0d0
      call checkerr(ierr,'heatconds',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (denssolid(nngl), stat = ierr)
      denssolid=0.0d0
      call checkerr(ierr,'denssolid',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (heatflux_a(ncon-1), stat = ierr)
      heatflux_a=0.0d0
      call checkerr(ierr,'heatflux_a',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (disheatx(nngl), stat = ierr)
      disheatx=0.0d0
      call checkerr(ierr,'disheatx',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (disheaty(nngl), stat = ierr)
      disheaty=0.0d0
      call checkerr(ierr,'disheaty',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (disheatz(nngl), stat = ierr)
      disheatz=0.0d0
      call checkerr(ierr,'disheatz',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (heatflux_c(ncon-1), stat = ierr)
      heatflux_c=0.0d0
      call checkerr(ierr,'heatflux_c',ilog)
      
      allocate (heatflux_d(ncon-1), stat = ierr)
      heatflux_d=0.0d0
      call checkerr(ierr,'heatflux_d',ilog)
      
      allocate (vsfluxheat(ncon-1), stat = ierr)
      vsfluxheat=0.0d0
      call checkerr(ierr,'vsfluxheat',ilog)
      
      allocate (dcoefheat(ncon-1), stat = ierr)
      dcoefheat=0.0d0
      call checkerr(ierr,'dcoefheat',ilog)
      
      allocate (del_temp(ncon-1), stat = ierr)
      del_temp=0.0d0
      call checkerr(ierr,'del_temp',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (resglob(2*nngl), stat = ierr)
      resglob=0.0d0
      call checkerr(ierr,'resglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
!c  data structure and solver - energy balance 
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif 
      allocate (iafglob(2*nngl+1), stat = ierr)
      iafglob=0
      call checkerr(ierr,'iafglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (iafdglob(2*nngl), stat = ierr)
      iafdglob=0 
      call checkerr(ierr,'iafdglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (lorderglob(2*nngl), stat = ierr)
      lorderglob=0 
      call checkerr(ierr,'lorderglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (invordglob(2*nngl), stat = ierr)
      invordglob=0 
      call checkerr(ierr,'invordglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (bglob(2*nngl), stat = ierr)
      bglob=0 
      call checkerr(ierr,'bglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (uglob(2*nngl), stat = ierr)
      uglob=0 
      call checkerr(ierr,'uglob',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      if (entalphy_change) then
        allocate (entalchg(nngl), stat = ierr)
        entalchg=0.0d0 
        call checkerr(ierr,'entalchg',ilog)
      end if
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp end sections
    !$omp end parallel
#endif
#endif      
      
      return
      end
