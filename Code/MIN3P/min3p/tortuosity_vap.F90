!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/tortuosity_vap.F90 $
!---------------------------------------------------------------------
!********************************************************************!
real*8 function tortuosity_vap(por_ivol,por_jvol,satv_ivol,satv_jvol) 
 
use parm
use gen
use dens
use phys 
use chem
 
implicit none
     
real*8, intent(in)  :: por_ivol

real*8, intent(in)  :: por_jvol

real*8, intent(in)  :: satv_ivol

real*8, intent(in)  :: satv_jvol

real*8, parameter   :: r0 = 0.0d0, r1 = 1.0d0, r2=2.0d0, r7=7.0d0, r3=3.0d0, rhalf = 0.5d0

real*8 :: por_av, satv_av
      
por_av = rhalf*(por_ivol+por_jvol)

satv_av = rhalf*(satv_ivol+satv_jvol)

tortuosity_vap = r0

select case (tort_model_vap)

case ('millington')

 tortuosity_vap = por_av * satv_av * ((por_av * satv_av)**(r7/r3))/(por_av**r2) 

case ('default')
 
 tortuosity_vap = por_av * satv_av    

case ('not consider')

 tortuosity_vap = r1

end select 

return
end function  