!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 3 $
!> $Author: dsu $
!> $Date: 2012-12-09 18:46:07 -0800 (Sun, 09 Dec 2012) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/mxie/src/min3p/datstr_1.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!
!c  -----------------------------------------------------------------------
!c  subroutine delcmigfunc
!c  -------------------
!c 
!c  compute the electric potential for aqueous component electrostatic  
!c  based on concentrations of free species and secondary aqueous species
!c 
!c  written by:      Pejman Rasouli - June 03, 2010
!c 
!c  last modified:   Pejman Rasouli - February 07, 2010
!c                   Electromigration term is computeted here
!c                   and the transport equation converted to
!c                   Nersnst-Planck equation 
!c                     
!c 
!c  definition of variables:
!c 
!c  I --> on input   * arbitrary  - initialized  + entries expected
!c  O --> on output  * arbitrary  - unaltered    + altered
!c                                                                     I O
!c  passed:   real*8:
!c            -------
!c            !c (nc)              = concentrations of free species      + -
!c                                 [moles/l water]
!c            cx(nx)             = concentrations of secondary aqueous + -
!c                                 species [moles/l water]
!c            totc(nc-1)         = total aqueous component             + -
!c                                 concentrations [moles/l water]
!c 
!c  common:
!c  chem.f:   real*8:
!c            -------
!c            xnux(nx*nc)        = stoichiometric coefficient matrix   + -
!c                                 for formation of secondary aqueous
!c                                 species from free species
!c 
!c            integer*4:
!c            ----------
!c            iax(nx+1)          = row pointer array to                + -
!c                                 stoichiometric coefficients of
!c                                 free species in
!c                                 secondary aqueous species
!c            jax(nx*nc)         = column pointer array to             + -
!c                                 stoichiometric coefficients of
!c                                 free species in secondary aqueous
!c                                 species
!c            nc                 = number of components including h2o  + -
!c            nx                 = number of secondary aqueous species + -
!c 
!c  local:    integer*4:
!c            ----------
!c            i                  = counter (stoichiometric
!c                                 coefficients)
!c            ic                 = counter (components)
!c            ix                 = counter (secondary aqueous species) 
!c            istart             = pointer (stoichiometric 
!c                                 coefficients)
!c            iend               = pointer (stoichiometric
!c                                 coefficients)
!c 
!c  external: -
!c  ----------------------------------------------------------------------
  
      subroutine delcmigfunc(elecmignew,elecmignew_pert,drtinc)            
     
      use parm
      use chem
      use gen
#ifdef OPENMP
      use omp_lib 
#endif 
 
      implicit none

      integer :: ibl, tid
      
      real*8 elecmignew(nc),elecmignew_pert(nc),drtinc  
#ifdef OPENMP
      tid = omp_get_thread_num() + 1
#else
      tid = 1
#endif
                   
      do ibl=1,nc-1
      
         delecmigrationnew(ibl,tid) = (elecmignew_pert(ibl)           &
     &                           - elecmignew(ibl))/drtinc
        
      end do

      return
      end