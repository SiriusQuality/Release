!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/mem_evap.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_evap
!c ----------------- 
!c Sergio Andres Bea Jofre (2009)
!c
!c ----------------------------------------------------------------------
  
      subroutine mem_evap
       
      use parm
      use gen
      use chem
      use dens
#ifdef OPENMP
      use omp_lib 
#endif

      implicit none
      
      integer :: ierr

      external checkerr
      
      
 
!cprovi-----------------------------------------------------------
!cprovi Allocate variables corresponding to evaporation processes 
!cprovi----------------------------------------------------------- 
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp parallel private(ierr)
    !$omp sections
#endif
#endif

#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (densvnew(nngl), stat = ierr)
      densvnew=1.0d-3 
      call checkerr(ierr,'densvnew',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif  
      allocate (densvold(nngl), stat = ierr)
      densvold=1.0d-3
      call checkerr(ierr,'densvold',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (ddensvdpa(nngl), stat = ierr)
      ddensvdpa=0.0d0
      call checkerr(ierr,'ddensvdpa',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (ddensvdt(nngl), stat = ierr)
      ddensvdt=0.0d0
      call checkerr(ierr,'ddensvdt',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (dsurftensdt(nngl), stat = ierr)
      dsurftensdt=0.0d0
      call checkerr(ierr,'dsurftensdt',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (vapflux(ncon-1), stat = ierr)
      vapflux=0.0d0
      call checkerr(ierr,'vapflux',ilog)
      
      allocate (heatflux_v(ncon-1), stat = ierr)
      heatflux_v=0.0d0
      call checkerr(ierr,'heatflux_v',ilog)
      
      allocate (vapfluxheat(ncon-1), stat = ierr)
      vapfluxheat=0.0d0
      call checkerr(ierr,'vapfluxheat',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (latvapnew(nngl), stat = ierr)
      latvapnew=0.0d0
      call checkerr(ierr,'latvapnew',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (latvapold(nngl), stat = ierr)
      latvapold=0.0d0
      call checkerr(ierr,'latvapold',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp end sections
    !$omp end parallel
#endif
#endif 
      return
      end
