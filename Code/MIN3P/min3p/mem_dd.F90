!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/mem_dd.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c -----------------------------------------------------------------------
!c subroutine mem_dd
!c -----------------
!c
!c allocate memory for density-dependant flow simulation
!c
!c written by:          Tom Henderson - August 9, 2002
!c
!c last modified:       Tom Henderson - January 10, 2005
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:
!c dens.f:    real*8:
!c           -------
!c           del_p(ncon-1)      = difference in total                 * +       
!c                                pressure potential
!c           del_z(ncon-1)      = difference in                       * +                   
!c                                elevation potential
!c           pressure(nngl)       = fluid pressure                      * +
!c           density(nngl)        = fluid density                       * +
!c           densold(nngl)        = fluid density from previous         * +
!c                                iteration/time step
!c           viscosity(nngl)      = fluid viscosity                     * +
!c           tds_new(nngl)        = total dissolved solids [mg/L]       * +
!c                                at current time step
!c           tds_old(nngl)        =  total dissolved solids [mg/L]      * +
!c                                at previous time step
!c           dcoef(ncon-1)      = coefficient including density,      * +
!c                                viscosity, and relative 
!c                                permeability
!c           ssdens(nngl)         = density of point source fluid       * +
!c
!c           integer*4:
!c           ----------
!c           ilog               = unit number, logbook file           + -
!c
!c local:    integer*4:
!c           ----------
!c           ierr               = 0 -> memory allocation successful
!c
!c external: checkerr  = check for error during memory allocation 
!c---------------------------------------------------------------------- 
!c WARNING
!c---------------------------------------------------------------------- 
!c All allocated variables are initialized to some value. This depends  
!c of its type:
!c 
!c real*8      => 0.0d0
!c integer     => 0 
!c character   => ' '    
!c logical     => .false. 
!c 
!c Sergio Andres Bea Jofre (2009)
!c
!c----------------------------------------------------------------------
  
      subroutine mem_dd
 
      use parm
      use gen
      use dens
      use phys
      
      implicit none
      
      integer :: ierr

      external checkerr
 
!c  main variables - density dependent flow
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp parallel private(ierr)
    !$omp sections
#endif
#endif

#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (density(nngl), stat = ierr)
      density=1.0d3
      call checkerr(ierr,'density',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (densold(nngl), stat = ierr)
      densold=1.0d3
      call checkerr(ierr,'densold',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (densold1(nngl), stat = ierr)
      densold1=1.0d3
      call checkerr(ierr,'densold',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (densold2(nngl), stat = ierr)
      densold2=1.0d3
      call checkerr(ierr,'densold2',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (viscosity(nngl), stat = ierr)
      viscosity=1.0d-3
      call checkerr(ierr,'viscosity',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (tds_new(nngl), stat = ierr)
      tds_new=0.0d0
      call checkerr(ierr,'tds_new',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (tds_old(nngl), stat = ierr)
      tds_old=0.0d0
      call checkerr(ierr,'tds_old',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (tds_old2(nngl), stat = ierr)
      tds_old2=0.0d0
      call checkerr(ierr,'tds_old2',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (ssdens(nngl), stat = ierr)
      ssdens=1.0d3
      call checkerr(ierr,'ssdens',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp section
#endif
#endif
      allocate (del_p(ncon-1), stat = ierr)
      del_p=0.0d0
      call checkerr(ierr,'del_p',ilog)

      allocate (del_z(ncon-1), stat = ierr)
      del_z=0.0d0
      call checkerr(ierr,'del_z',ilog)

      allocate (dcoef(ncon-1), stat = ierr)
      dcoef=0.0d0
      call checkerr(ierr,'dcoef',ilog)
      
      allocate (modify_por(nngl), stat = ierr)
      modify_por=.false. 
      call checkerr(ierr,'modify_por',ilog)
#ifdef OPENMP
#ifdef PARALLEL_SECTION
    !$omp end sections
    !$omp end parallel
#endif
#endif 
      return
      end
