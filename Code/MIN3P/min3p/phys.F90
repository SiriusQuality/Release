!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 488 $
!> $Author: cblitz $
!> $Date: 2017-07-17 18:22:05 +0200 (Mon, 17 Jul 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/phys.F90 $
!---------------------------------------------------------------------
!********************************************************************!

      module phys

      use parm
      
      implicit none

!c ----------------------------------------------------------------------
!c common - physical variables
!c
!c ----------------------------------------------------------------------
!c porous medium:
!c --------------
!c        -->                                                         <--
!c           real*8:
!c           -------
!c           por                = porosity
!c
!c           character:
!c           ----------
!c           mprop_name(nzn)    = name of material property zone
!c
!c        -->                                                         <--
!c ----------------------------------------------------------------------


      real (type_r8) :: por

      character*72, allocatable :: mprop_name(:)

!c ----------------------------------------------------------------------
!c variably saturated flow:
!c ------------------------
!c        -->                                                         <--
!c           real*8:
!c           -------
!c           aentry(nzn)        = air entry pressure       
!c           condxx(nzn)        = saturated hydraulic conductivity 
!c                                in x-direction
!c           condyy(nzn)        = saturated hydraulic conductivity 
!c                                in y-direction
!c           condzz(nzn)        = saturated hydraulic conductivity 
!c                                in z-direction
!c           expn(nzn)          = soil hydraulic function parameter
!c           permx(nn)          = saturated permeability in 
!c                                x-direction
!c           permy(nn)          = saturated permeability in 
!c                                y-direction
!c           permz(nn)          = saturated permeability in 
!c                                z-direction
!c           spalpha(nzn)       = soil hydraulic function parameter
!c           spbeta(nzn)        = soil hydraulic function parameter
!c           spgamma(nzn)       = soil hydraulic function parameter
!c           spstor(nzn)        = specific storage coefficient
!c           swr(nzn)           = residual saturation           
!c           satwlim(nzn)       = water saturation at wilting point
!c           satwfield(nzn)     = water saturation at field capacity
!c           rew0(izn)          = relative extractable water at
!c                                50% of maximum extraction capacity 
!c                                (fitting parameter)
!c           p1(nzn)            = fitting parameter for root water
!c                                uptake function
!c           rate_root_max(nzn) = maximum root water uptake rate
!c           satwdry(nzn)       = air-dry water saturation
!c           h1dry(nzn)         = air-dry aqueous pressure ! CBF ADDED
!c           pvol(nzn)          = volume of property zone (used for evaporation)  !CBF ADDED
!c           root_length_dens(nzn) = root length density
!c           tree_trans_factor(nzn) = tree transpiration factor
!c           canopy_evap_factor(nzn) = efficiency factor for canopy
!c                                     evaporation
!c
!c           integer*4:
!c           ----------
!c           nzn                = number of material property zones
!c
!c           logical:
!c           --------
!c           permeability_field = .true.  -> read permeability field
!c                                .false. -> specify permeabilities
!c                                           in input file
!c           pure_evaporation   = .true.  -> physical evaporation only ! CBF ADDED
!c           oil_saturation     = .true.  -> read oil saturation field
!c                                           account for decrease in
!c                                           porosity due to oil
!c                                           account for decrease in 
!c                                           aqueous saturation
!c                                .false. -> oil is not present
!c        -->                                                         <--
!c ----------------------------------------------------------------------

      real (type_r8), allocatable :: pvol(:) ! CBF ADDED
      real (type_r8), allocatable :: condxx(:)
      real (type_r8), allocatable :: condyy(:)
      real (type_r8), allocatable :: condzz(:)
      real (type_r8), allocatable :: permx(:)
      real (type_r8), allocatable :: permy(:)
      real (type_r8), allocatable :: permz(:)
      real (type_r8), allocatable :: spstor(:)
      real (type_r8), allocatable :: swr(:)
      real (type_r8), allocatable :: spalpha(:)
      real (type_r8), allocatable :: spbeta(:)
      real (type_r8), allocatable :: spgamma(:)
      real (type_r8), allocatable :: expn(:)
      real (type_r8), allocatable :: aentry(:)
!      real (type_r8), allocatable :: satwlim(:) !CBF - FG dec 2020 moved to biol.f, as it was
!      real (type_r8), allocatable :: satwfield(:) !CBF - FG dec 2020 moved to biol.f, as it was
      real (type_r8), allocatable :: rate_root_max(:)
      real (type_r8), allocatable :: satwdry(:) ! CBF 
      real (type_r8), allocatable :: h1dry(:) ! CBF 
      real (type_r8), allocatable :: root_length_dens(:)
      real (type_r8), allocatable :: tree_trans_factor(:)
      ! CBF put in biol.F90 real (type_r8), allocatable :: canopy_evap_factor(:)
!FG dec 2020 put in biol.F90      real (type_r8), allocatable :: p1(:)
!FG dec 2020 put in biol.F90      real (type_r8), allocatable :: rew0(:)


      integer (type_i4) nzn

      logical :: permeability_field
      logical :: pure_evaporation ! CBF ADDED
      logical :: oil_saturation
      
      real (type_r8)              :: sgr ! Gas residual saturation      
      !cprovi----------------------------------------------------------
      !cprovi Porosity filed boolean 
      !cprovi Sergio Andres Bea Jofre 
      !cprovi----------------------------------------------------------
      logical :: porosity_field
      logical :: tortuosity_field
      logical :: dispersivity_field
      logical :: storcoeff_field
      !cprovi----------------------------------------------------------
!c ----------------------------------------------------------------------
!c reactive transport:
!c -------------------
!c        -->                                                         <--
!c           real*8:
!c           -------
!c           disx(nzn)          = longitudinal dispersivity
!c           disy(nzn)          = transverse horizontal dispersivity
!c           disz(nzn)          = transverse vertical dispersivity
!c           diff_a             = free diffusion coefficient in aqueous
!c                                phase (equal for all species)
!c           diff_g             = free diffusion coefficient in gaseous
!c                                phase (equal for all species)
!c        -->                                                         <--
!c ----------------------------------------------------------------------

      real (type_r8), allocatable :: disx(:) 
      real (type_r8), allocatable :: disy(:)
      real (type_r8), allocatable :: disz(:) 

      real (type_r8) :: diff_a
      real (type_r8) :: diff_g
       
!cprovi------------------------------------------------------------------
!cprovi 
!cprovi------------------------------------------------------------------
      real (type_r8), allocatable :: permx0(:)
      real (type_r8), allocatable :: permy0(:)
      real (type_r8), allocatable :: permz0(:)
!cprovi------------------------------------------------------------------
!cprovi Parameters for oven dry model
!cprovi Fayer, M.J. & C.S. Simmons, 1995. Modified Soil Water 
!cprovi Retention Functions for All Matric Suctions, 
!cprovi Water Resour. Res. 31(5), 1233?238.
!cprovi------------------------------------------------------------------
      real (type_r8), allocatable :: hm_ovendry(:)
      real (type_r8), allocatable :: w0_ovendry(:)
      real (type_r8), allocatable :: beta_ovendry(:)
      real (type_r8), allocatable :: cp0_ovendry(:)
      logical, allocatable        :: isovendrying(:)
!cprovi------------------------------------------------------------------
!cprovi------------------------------------------------------------------
!cprovi------------------------------------------------------------------

!c ----------------------------------------------------------------------
!c gas transport:
!c ---------------------------
!c modified: Sergi Molins - May 2, 2006
!c
!c        -->                                                         <--
!c           real*8:
!c           -------
!c           dens_h2o           = density of the aqueous phase
!c           visc_h2o           = viscosity of the aqueous phase
!c           dens_gcnst         = constant density of the gas phase
!c           visc_gconst        = viscosity of the gas phase
!c           dens_g(nn)         = density of the gas phase
!c           visc_g(nn)         = viscosity of the gas phase
!c           mdens_g(nn)        = molar density of the gas phase
!c           visc_comp_g(ng)    = individual viscosities
!c           diff_bin_g(ng,ng)  = binary diffusion coefficients
!c           theta_diff         = exponent of temp correction (diff_temp=.true.)
!c
!c           logical:
!c           --------
!c           update_dens_g      = update density based on concs/mol fract
!c           blanc_diff_g       = calculate diff coeff using Blanc's expr
!c           diff_press         = correct diff_bin_g for dependence on pres
!c           diff_temp          = correct diff_bin_g for dependence on temp
!c
!c           character:
!c           ----------
!c           variable_visc_g    = variable viscosity (const,Wilke,linear)
!c        -->                                                         <--
!c ----------------------------------------------------------------------

       real (type_r8) :: dens_h2o 
       real (type_r8) :: visc_h2o

       real (type_r8) :: dens_gcnst 
       real (type_r8) :: visc_gcnst

       real (type_r8) :: theta_diff

       real (type_r8), allocatable :: dens_g(:)
       real (type_r8), allocatable :: visc_g(:)
       real (type_r8), allocatable :: mdens_g(:)

       logical :: update_dens_g
       logical :: blanc_diff_g
       logical :: diff_press
       logical :: diff_temp

       character*8 :: variable_visc_g
     
       real (type_r8), allocatable :: visc_comp_g(:)  
       real (type_r8), allocatable :: diff_bin_g(:,:) 

      end module phys
