!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 221 $
!> $Author: dsu $
!> $Date: 2014-08-05 23:29:49 +0200 (Tue, 05 Aug 2014) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/updtsvgp.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine updtsvgp
!c -------------------
!c
!c update secondary variables in gaseous phase
!c - gas concentrations
!c - total gaseous component concentrations
!c
!c written by:      Uli Mayer - September 27, 96
!c
!c last modified:   Uli Mayer - November 28, 96 
!c
!c definition of variables:
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           c(nc)              = concentrations of free species      + -
!c                                - new time level [moles/l water]
!c           gammac(nc)         = activity coefficients for free      + -
!c                                species
!c           g(ng)              = gas concentrations [moles/l air]    * +
!c           tempkel            = temperature [deg K]                 + -
!c           totcg(nc-1)        = total gaseous component             * +
!c                                concentrations [moles/l air]
!c common:
!c chem.f:   integer*4:
!c           ----------
!c           ng                 = number of gases                     + -
!c
!c local:    integer*4:
!c           ----------
!c           ig                 = counter (gases)
!c
!c external: gasconc   = compute gas concentrations based on free
!c                       species concentrations
!c           totconcg  = compute total gaseous component
!c                       concentrations based on gas concentrations
!c ----------------------------------------------------------------------
 
      subroutine updtsvgp (c,gammac,g,totcg,tempkel)
 
      use parm
      use chem
 
      implicit none
      
      real*8 :: c, gammac, g, totcg, tempkel

      dimension c(*),gammac(*),g(*),totcg(*)
 
      external totconcg
      
      integer :: ig
      
      !For the shared-memory parallel version, the variables defined in the module
      !are shared variables by different threads. So as to avoid race condition, 
      !these variable should be passed by dummy arguments. Danyang Su, 2013-05.
      interface
      
        !>interface gasconc
        subroutine gasconc(c,gammac,g,ig,tempkel)
          use parm, only : type_i4, type_r8
          real(type_r8), dimension(*) :: c
          real(type_r8), dimension(*) :: gammac
          real(type_r8) :: g
          integer(type_i4) :: ig
          real(type_r8) :: tempkel   
        end subroutine gasconc
      
      end interface

!c  compute gas concentrations

      do ig = 1,ng
        call gasconc(c,gammac,g(ig),ig,tempkel)
      end do

!c  compute total gaseous component concentrations

      call totconcg(g,totcg)

      return
      end
