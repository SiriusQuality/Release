!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/distmp.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine distmp
!c -----------------
!c
!c distribute mineralogical parameters 
!c
!c written by:      Uli Mayer - March 6, 98
!c
!c last modified:   -
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           aream(nm)          = specific reactive surface area of   + -
!c                                mineral A_i^m
!c                                [m^2 mineral/L bulk]      
!c                                (surface controlled reactions)
!c                                reactivity term 
!c                                [m mineral/m^3 bulk]
!c                                (transport controlled reactions)
!c           cmnewm(nm)         = concentration of minerals           + -
!c                                - new time level [moles/l bulk]
!c           phim(nm)           = volume fraction of minerals         + - 
!c
!c common:
!c chem.f:   real*8:
!c           -------
!c           cmcmin(nm,nthreads)= min. concentration of minerals      + -
!c                                [moles/l bulk]
!c           integer*4:
!c           ----------
!c           iamp(nm+1)         = pointer array for distribution      + -
!c                                and combination of mineralogical
!c                                parameters
!c           iamp(nm)           = pointer array for distribution      + -
!c                                and combination of mineralogical
!c                                parameters
!c           nm                 = number of minerals                  + -
!c
!c
!c local:    i1                 = counter
!c           im                 = counter
!c           im2                = counter
!c           istart             = pointer
!c           istop              = pointer
!c           
!c
!c external: -
!c ----------------------------------------------------------------------
 
      subroutine distmp(cmnewm,phim,aream)
 
      use parm
      use chem
#ifdef OPENMP
      use omp_lib 
#endif
 
      implicit none
      
      integer :: tid
      
      real*8 :: cmnewm,phim,aream

      dimension cmnewm(*),phim(*),aream(*)
      
      integer :: i1, im, im2, istart, istop
      
#ifdef OPENMP
      tid = omp_get_thread_num() + 1
#else
      tid = 1
#endif
  
!c  distribute mineralogical parameters

      do im = 1,nm

        istart = iamp(im)
        istop = iamp(im+1)-1

        do i1 = istart,istop

          im2 = jamp(i1)
 
          phim(im2) = phim(im)
          phiinit(im2,tid) = phiinit(im,tid)
          cmcmin(im2,tid) = cmcmin(im,tid)
          cmnewm(im2) = cmnewm(im)

!cbenner   aream(im2) = aream(im)
!c         areainit(im2) = areainit(im)
!c         cmoldm(im2) = cmoldm(im)
!          
!c         phimin(im2) = phimin(im)
!c         radi(im2) = radi(im)
!c         radmin(im2) = radmin(im)
!c         rads(im2) = rads(im)
!c         scalfac(im2) = scalfac(im)
!c         update_type(im2) = update_type(im)

        end do

      end do
 
      return
      end
