!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/tranflow.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c subroutine tranflow
!c -------------------
!c
!c driver subroutine for transient flow 
!c
!c written by:      Uli Mayer - May 8, 96
!c
!c last modified:   Uli Mayer - December 6, 96
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   -
!c
!c common:   
!c gen.f:    integer*4:
!c           ----------
!c           ilog               = unit number, log file               + -
!c           idetail_vs         = information level                   + -
!c                                (variably saturated flow)    
!c
!c           logical:
!c           --------
!c           fully_saturated    = .true.  -> saturated conditions     + -
!c           variably_saturated = .true.  -> .not.fully_saturated,    + -
!c                                        -> variably saturated
!c                                           conditions
!c
!c local:    - 
!c
!c external: fsflow    = driver subroutine for fully saturated 
!c                       flow 
!c           vsflow    = driver subroutine for variably saturated 
!c                       flow 
!c ----------------------------------------------------------------------

      subroutine tranflow

      use parm
      use gen

      implicit none
      
#ifdef PETSC_V3_6_X
#include <petsc/finclude/petscsys.h>
#elif PETSC
#include <finclude/petscsys.h>
#endif

      integer :: i

      external fsflow, vsflow
      

      if(rank == 0 .and. b_enable_output) then      !if MPI rank 0

      if (idetail_vs.gt.0) then
        if (fully_saturated) then
          write(ilog,'(a)')'transient flow - saturated conditions'
        elseif (variably_saturated) then
          write(ilog,'(2a)')'transient flow - ',          &
     &                   'variably saturated conditions'
        end if
        write(ilog,'(72a/)')('-',i=1,72)
      end if

      end if                  !end if MPI rank 0


!c for saturated conditions

      if (fully_saturated) then
        call fsflow

!c for variably saturated conditions

      elseif (variably_saturated) then
        call vsflow
      end if

      return
      end
