!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 453 $
!> $Author: dsu $
!> $Date: 2017-02-21 19:54:05 +0100 (Tue, 21 Feb 2017) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/min3p/boundary_func.F90 $
!---------------------------------------------------------------------
!********************************************************************!

!c ----------------------------------------------------------------------
!c real*8 function tranbcrt
!c ---------------------
!c compute transient boundary condition value
!c
!c written by:      Danyang Su - February 19, 2015
!c
!c method:
!c
!c           Transient function: 4-parameter sine function or 
!c           polynomial function
!c           Sine function: f(t) = A*SIN(B*t+C)+D, where B*t+C is radian
!c           Polynomial function: f(t) = A*t^3+B*t^2+C*t+D
!c           For constant boundary condition, set A, B and C to 0 and 
!c           D to the constant
!c
!c last modified:   
!c
!c
!c definition of variables:
!c
!c I --> on input   * arbitrary  - initialized  + entries expected
!c O --> on output  * arbitrary  - unaltered    + altered
!c                                                                    I O
!c passed:   real*8:
!c           -------
!c           parms(nparms)      = parameters array                    + -
!c                                parms(1): function type
!c                                parms(2): function scaling value
!c                                parms(3:6): parameters A to D in the 
!c                                            function
!c           vart               = input variable t in f(t)
!c
!c           integer*4
!c           -------
!c           nparms             = size of parameters array, this value
!c                                is 6 for the current polynomial 
!c                                function or sine function
!c 
!c local:    real*8:
!c           ------- 
!c
!c           integer*4:
!c           ----------
!c
!c external: -
!c ---------------------------------------------------------------------- 

      real*8 function boundary_func(nparms, parms, vart)

      implicit none
      
      integer :: nparms
      real*8  :: parms(nparms)
      real*8 :: vart
      
      boundary_func = 0.0d0
      
      if (nparms /= 6) then
        boundary_func = -1.0D300
      end if
      
      if (parms(1) > 1 .and. parms(1) < 3) then      !use polynomial function
        boundary_func = parms(2)*(parms(3)*vart**3 +                   &
                                  parms(4)*vart**2 +                   &
                                  parms(5)*vart + parms(6))
      else if (parms(1) > 3 .and. parms(1) < 5) then !use sine function
        boundary_func = parms(2)*(parms(3)*sin(parms(4)*vart+parms(5))+&
                                  parms(6))
      else
        boundary_func = parms(2)*parms(6)  
        
      end if
      
      return
      
      end
