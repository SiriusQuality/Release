!*****Revision Informations Automatically Generated by VisualSVN*****!
!---------------------------------------------------------------------
!> $ID:$
!> $Revision: 296 $
!> $Author: dsu $
!> $Date: 2015-04-07 22:22:37 +0200 (Tue, 07 Apr 2015) $
!> $URL: https://biot.eos.ubc.ca/svn/min3p_thcm/branches/fgerard_new/src/dgm/read_tau.F90 $
!---------------------------------------------------------------------
!********************************************************************!

      subroutine read_tau
	
	  use gen
      use file_unit, only : lun_get, lun_free
#ifdef PETSC
      use petsc_mpi_common, only : petsc_mpi_finalize
#endif
      
	  implicit none
	  
	  external relpfsat, relpfsat_g
      
	  character*1 cdummy
      real*8 :: rdummy
      integer :: igvs, ivol, iskip, nskip
      
!c	  real*8      tauivol(nn)
	  
	  igvs = lun_get()
      
	  open(igvs,file=prefix(:l_prfx)//'.gvs',status='unknown',         &
           form='formatted')
      
      if(rank == 0 .and. b_enable_output) then    
	    write(ilog,'(/a)') ' read gas tortuosity values from file'
      end if
	  
!c       ignore first 3 lines
      read(igvs,*,err=998,end=998) cdummy
      read(igvs,*,err=998,end=998) cdummy
	  read(igvs,*,err=998,end=998) cdummy
      
      nskip = 0
      do ivol = 1,nngl
#ifdef PETSC
        do iskip = 1, node_idx_lg2g(ivol) - nskip -1  
            read(itor,*,end=998,err=998) rdummy
        end do
        nskip = node_idx_lg2g(ivol)
#endif
        read(igvs,*,err=998,end=998) rdummy, rdummy, rdummy,           &
                                     tauivol(ivol)
      end do
	
	  close (igvs)
      call lun_free(igvs)
	
      goto 1000

998   continue
      if (rank == 0) then
        write(ilog,*) 'SIMULATION TERMINATED'
        write(ilog,*) 'error reading nodal gas tortuosity field ',     &
                      'from file'
        write(ilog,*) 'subroutine read_tau'
      end if
      close(ilog)
#ifdef PETSC
      call petsc_mpi_finalize
#endif
      stop

1000  return
      end


      